2025-12-31 09:39:14 - StockClustering - INFO - main:72 - Args Data Collect : False
2025-12-31 09:39:14 - StockClustering - INFO - main:92 - Start loading data from collected already
2025-12-31 09:39:17 - StockClustering - INFO - main:99 - End   loading data
2025-12-31 09:39:17 - StockClustering - INFO - main:106 - Start GMM clustering
2025-12-31 09:39:34 - StockClustering - ERROR - main:124 - Fatal error: 'Year'
Traceback (most recent call last):
  File "C:\Users\ParkYoungSig\.conda\envs\myp\Lib\site-packages\pandas\core\indexes\base.py", line 3812, in get_loc
    return self._engine.get_loc(casted_key)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "pandas/_libs/index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Year'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\ai-quant\Project_1\youngsig\src\main.py", line 108, in main
    gmm_report = gmm.run()
  File "D:\ai-quant\Project_1\youngsig\src\gmm_clustering.py", line 333, in run
    return run_gmm_pipeline(
        df=self.df,
    ...<2 lines>...
        manual_k=manual_k,
    )
  File "D:\ai-quant\Project_1\youngsig\src\gmm_clustering.py", line 134, in run_gmm_pipeline
    years = df_clean["Year"].to_numpy()
            ~~~~~~~~^^^^^^^^
  File "C:\Users\ParkYoungSig\.conda\envs\myp\Lib\site-packages\pandas\core\frame.py", line 4113, in __getitem__
    indexer = self.columns.get_loc(key)
  File "C:\Users\ParkYoungSig\.conda\envs\myp\Lib\site-packages\pandas\core\indexes\base.py", line 3819, in get_loc
    raise KeyError(key) from err
KeyError: 'Year'
2025-12-31 09:39:49 - StockClustering - INFO - main:72 - Args Data Collect : False
2025-12-31 09:39:49 - StockClustering - INFO - main:92 - Start loading data from collected already
2025-12-31 09:39:51 - StockClustering - INFO - main:99 - End   loading data
2025-12-31 09:39:51 - StockClustering - INFO - main:101 - Start KMeans clustering
2025-12-31 09:40:49 - StockClustering - INFO - main:104 - End   KMeans clustering
2025-12-31 09:42:22 - StockClustering - INFO - main:72 - Args Data Collect : False
2025-12-31 09:42:22 - StockClustering - INFO - main:92 - Start loading data from collected already
2025-12-31 09:42:24 - StockClustering - INFO - main:99 - End   loading data
2025-12-31 09:42:24 - StockClustering - INFO - main:111 - Start HDBScan clustering
2025-12-31 09:42:25 - StockClustering - INFO - main:114 - End   HDBScan clustering
2025-12-31 09:49:04 - StockClustering - INFO - main:72 - Args Data Collect : False
2025-12-31 09:49:04 - StockClustering - INFO - main:92 - Start loading data from collected already
2025-12-31 09:49:06 - StockClustering - INFO - main:99 - End   loading data
2025-12-31 09:49:06 - StockClustering - INFO - main:106 - Start GMM clustering
2025-12-31 09:49:24 - StockClustering - ERROR - main:124 - Fatal error: 'Year'
Traceback (most recent call last):
  File "C:\Users\ParkYoungSig\.conda\envs\myp\Lib\site-packages\pandas\core\indexes\base.py", line 3812, in get_loc
    return self._engine.get_loc(casted_key)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "pandas/_libs/index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Year'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\ai-quant\Project_1\youngsig\src\main.py", line 108, in main
    gmm_report = gmm.run()
  File "D:\ai-quant\Project_1\youngsig\src\gmm_clustering.py", line 333, in run
    return run_gmm_pipeline(
        df=self.df,
    ...<2 lines>...
        manual_k=manual_k,
    )
  File "D:\ai-quant\Project_1\youngsig\src\gmm_clustering.py", line 134, in run_gmm_pipeline
    years = df_clean["Year"].to_numpy()
            ~~~~~~~~^^^^^^^^
  File "C:\Users\ParkYoungSig\.conda\envs\myp\Lib\site-packages\pandas\core\frame.py", line 4113, in __getitem__
    indexer = self.columns.get_loc(key)
  File "C:\Users\ParkYoungSig\.conda\envs\myp\Lib\site-packages\pandas\core\indexes\base.py", line 3819, in get_loc
    raise KeyError(key) from err
KeyError: 'Year'
2025-12-31 10:34:35 - StockClustering - INFO - main:72 - Args Data Collect : True
2025-12-31 10:34:35 - StockClustering - INFO - main:82 - Start collecting
2025-12-31 10:45:39 - StockClustering - INFO - main:86 - End   collecting
2025-12-31 10:46:12 - StockClustering - INFO - main:72 - Args Data Collect : True
2025-12-31 10:46:12 - StockClustering - INFO - main:82 - Start collecting
2025-12-31 10:58:14 - StockClustering - INFO - main:86 - End   collecting
2025-12-31 14:50:07 - StockClustering - INFO - main:72 - Args Data Collect : False
2025-12-31 14:50:07 - StockClustering - INFO - main:92 - Start loading data from collected already
2025-12-31 14:50:09 - StockClustering - INFO - main:99 - End   loading data
2025-12-31 14:50:09 - StockClustering - INFO - main:101 - Start KMeans clustering
2025-12-31 14:50:58 - StockClustering - INFO - main:104 - End   KMeans clustering
2025-12-31 14:50:58 - StockClustering - INFO - main:106 - Start GMM clustering
2025-12-31 14:51:39 - StockClustering - ERROR - main:126 - Fatal error: only 0-dimensional arrays can be converted to Python scalars
Traceback (most recent call last):
  File "D:\ai-quant\Project_1\youngsig\src\main.py", line 108, in main
    gmm_report = gmm.run()
  File "D:\ai-quant\Project_1\youngsig\src\gmm_clustering.py", line 488, in run
    return run_gmm_pipeline(
        df=self.df,
    ...<2 lines>...
        manual_k=manual_k,
    )
  File "D:\ai-quant\Project_1\youngsig\src\gmm_clustering.py", line 179, in run_gmm_pipeline
    labels_map, probs_map, _quality_map, last_model, sort_feature = train_gmm_per_year(
                                                                    ~~~~~~~~~~~~~~~~~~^
        X_feats, years, df_clean.index, feature_cols_used, final_k
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\ai-quant\Project_1\youngsig\src\gmm\pipeline_logic.py", line 184, in train_gmm_per_year
    mapping = align_clusters(
        prev_centers,
    ...<3 lines>...
        metric=config.GMM_ALIGN_METRIC,
    )
  File "D:\ai-quant\Project_1\youngsig\src\gmm\model.py", line 423, in align_clusters
    cost_matrix[i, j] = bhattacharyya_distance(
                        ~~~~~~~~~~~~~~~~~~~~~~^
        curr_centers[i],
        ^^^^^^^^^^^^^^^^
    ...<2 lines>...
        _cov_mat(prev_covs[j]),
        ^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\ai-quant\Project_1\youngsig\src\gmm\model.py", line 456, in bhattacharyya_distance
    term1 = 0.125 * float(dm.T @ inv_S @ dm)
                    ~~~~~^^^^^^^^^^^^^^^^^^^
TypeError: only 0-dimensional arrays can be converted to Python scalars
2025-12-31 14:52:39 - StockClustering - INFO - main:72 - Args Data Collect : False
2025-12-31 14:52:39 - StockClustering - INFO - main:92 - Start loading data from collected already
2025-12-31 14:52:41 - StockClustering - INFO - main:99 - End   loading data
2025-12-31 14:52:41 - StockClustering - INFO - main:101 - Start KMeans clustering
2025-12-31 14:53:28 - StockClustering - INFO - main:104 - End   KMeans clustering
2025-12-31 14:53:28 - StockClustering - INFO - main:116 - Start generating report 
2025-12-31 14:54:00 - StockClustering - INFO - main:119 - End generating report 
2025-12-31 14:55:23 - StockClustering - INFO - main:72 - Args Data Collect : False
2025-12-31 14:55:23 - StockClustering - INFO - main:92 - Start loading data from collected already
2025-12-31 14:55:25 - StockClustering - INFO - main:99 - End   loading data
2025-12-31 14:55:25 - StockClustering - INFO - main:101 - Start KMeans clustering
2025-12-31 14:56:11 - StockClustering - INFO - main:104 - End   KMeans clustering
2025-12-31 14:56:11 - StockClustering - INFO - main:117 - Start generating report 
2025-12-31 14:56:11 - StockClustering - INFO - main:119 - End generating report 
2025-12-31 15:15:50 - StockClustering - INFO - main:72 - Args Data Collect : False
2025-12-31 15:15:50 - StockClustering - INFO - main:92 - Start loading data from collected already
2025-12-31 15:15:52 - StockClustering - INFO - main:99 - End   loading data
2025-12-31 15:15:52 - StockClustering - INFO - main:101 - Start KMeans clustering
2025-12-31 15:16:42 - StockClustering - INFO - main:104 - End   KMeans clustering
2025-12-31 15:16:42 - StockClustering - INFO - main:106 - Start GMM clustering
2025-12-31 15:17:29 - StockClustering - ERROR - main:126 - Fatal error: only 0-dimensional arrays can be converted to Python scalars
Traceback (most recent call last):
  File "D:\ai-quant\Project_1\youngsig\src\main.py", line 108, in main
    gmm_report = gmm.run()
  File "D:\ai-quant\Project_1\youngsig\src\gmm_clustering.py", line 488, in run
    return run_gmm_pipeline(
        df=self.df,
    ...<2 lines>...
        manual_k=manual_k,
    )
  File "D:\ai-quant\Project_1\youngsig\src\gmm_clustering.py", line 179, in run_gmm_pipeline
    labels_map, probs_map, _quality_map, last_model, sort_feature = train_gmm_per_year(
                                                                    ~~~~~~~~~~~~~~~~~~^
        X_feats, years, df_clean.index, feature_cols_used, final_k
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\ai-quant\Project_1\youngsig\src\gmm\pipeline_logic.py", line 184, in train_gmm_per_year
    mapping = align_clusters(
        prev_centers,
    ...<3 lines>...
        metric=config.GMM_ALIGN_METRIC,
    )
  File "D:\ai-quant\Project_1\youngsig\src\gmm\model.py", line 423, in align_clusters
    cost_matrix[i, j] = bhattacharyya_distance(
                        ~~~~~~~~~~~~~~~~~~~~~~^
        curr_centers[i],
        ^^^^^^^^^^^^^^^^
    ...<2 lines>...
        _cov_mat(prev_covs[j]),
        ^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\ai-quant\Project_1\youngsig\src\gmm\model.py", line 456, in bhattacharyya_distance
    term1 = 0.125 * float(dm.T @ inv_S @ dm)
                    ~~~~~^^^^^^^^^^^^^^^^^^^
TypeError: only 0-dimensional arrays can be converted to Python scalars
2025-12-31 15:21:52 - StockClustering - INFO - main:72 - Args Data Collect : False
2025-12-31 15:21:52 - StockClustering - INFO - main:92 - Start loading data from collected already
2025-12-31 15:21:54 - StockClustering - INFO - main:99 - End   loading data
2025-12-31 15:21:54 - StockClustering - INFO - main:101 - Start KMeans clustering
2025-12-31 15:22:44 - StockClustering - INFO - main:104 - End   KMeans clustering
2025-12-31 15:22:44 - StockClustering - INFO - main:106 - Start GMM clustering
2025-12-31 15:23:28 - StockClustering - ERROR - main:126 - Fatal error: name 'GMM_COVARIANCE_TYPE' is not defined
Traceback (most recent call last):
  File "D:\ai-quant\Project_1\youngsig\src\main.py", line 108, in main
    gmm_report = gmm.run()
  File "D:\ai-quant\Project_1\youngsig\src\gmm_clustering.py", line 488, in run
    return run_gmm_pipeline(
        df=self.df,
    ...<2 lines>...
        manual_k=manual_k,
    )
  File "D:\ai-quant\Project_1\youngsig\src\gmm_clustering.py", line 179, in run_gmm_pipeline
    labels_map, probs_map, _quality_map, last_model, sort_feature = train_gmm_per_year(
                                                                    ~~~~~~~~~~~~~~~~~~^
        X_feats, years, df_clean.index, feature_cols_used, final_k
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\ai-quant\Project_1\youngsig\src\gmm\pipeline_logic.py", line 170, in train_gmm_per_year
    covariance_type=GMM_COVARIANCE_TYPE,
                    ^^^^^^^^^^^^^^^^^^^
NameError: name 'GMM_COVARIANCE_TYPE' is not defined
2025-12-31 15:25:54 - StockClustering - INFO - main:72 - Args Data Collect : False
2025-12-31 15:25:54 - StockClustering - INFO - main:92 - Start loading data from collected already
2025-12-31 15:25:56 - StockClustering - INFO - main:99 - End   loading data
2025-12-31 15:25:56 - StockClustering - INFO - main:106 - Start GMM clustering
2025-12-31 15:26:44 - StockClustering - ERROR - main:126 - Fatal error: name 'GMM_N_INIT' is not defined
Traceback (most recent call last):
  File "D:\ai-quant\Project_1\youngsig\src\main.py", line 108, in main
    gmm_report = gmm.run()
  File "D:\ai-quant\Project_1\youngsig\src\gmm_clustering.py", line 488, in run
    return run_gmm_pipeline(
        df=self.df,
    ...<2 lines>...
        manual_k=manual_k,
    )
  File "D:\ai-quant\Project_1\youngsig\src\gmm_clustering.py", line 179, in run_gmm_pipeline
    labels_map, probs_map, _quality_map, last_model, sort_feature = train_gmm_per_year(
                                                                    ~~~~~~~~~~~~~~~~~~^
        X_feats, years, df_clean.index, feature_cols_used, final_k
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\ai-quant\Project_1\youngsig\src\gmm\pipeline_logic.py", line 173, in train_gmm_per_year
    n_init=GMM_N_INIT,
           ^^^^^^^^^^
NameError: name 'GMM_N_INIT' is not defined
2025-12-31 15:30:02 - StockClustering - INFO - main:72 - Args Data Collect : False
2025-12-31 15:30:02 - StockClustering - INFO - main:92 - Start loading data from collected already
2025-12-31 15:30:04 - StockClustering - INFO - main:99 - End   loading data
2025-12-31 15:30:04 - StockClustering - INFO - main:106 - Start GMM clustering
2025-12-31 15:30:48 - StockClustering - ERROR - main:126 - Fatal error: only 0-dimensional arrays can be converted to Python scalars
Traceback (most recent call last):
  File "D:\ai-quant\Project_1\youngsig\src\main.py", line 108, in main
    gmm_report = gmm.run()
  File "D:\ai-quant\Project_1\youngsig\src\gmm_clustering.py", line 488, in run
    return run_gmm_pipeline(
        df=self.df,
    ...<2 lines>...
        manual_k=manual_k,
    )
  File "D:\ai-quant\Project_1\youngsig\src\gmm_clustering.py", line 179, in run_gmm_pipeline
    labels_map, probs_map, _quality_map, last_model, sort_feature = train_gmm_per_year(
                                                                    ~~~~~~~~~~~~~~~~~~^
        X_feats, years, df_clean.index, feature_cols_used, final_k
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\ai-quant\Project_1\youngsig\src\gmm\pipeline_logic.py", line 197, in train_gmm_per_year
    mapping = align_clusters(
        prev_centers,
    ...<3 lines>...
        metric=GMM_ALIGN_METRIC,
    )
  File "D:\ai-quant\Project_1\youngsig\src\gmm\model.py", line 423, in align_clusters
    cost_matrix[i, j] = bhattacharyya_distance(
                        ~~~~~~~~~~~~~~~~~~~~~~^
        curr_centers[i],
        ^^^^^^^^^^^^^^^^
    ...<2 lines>...
        _cov_mat(prev_covs[j]),
        ^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\ai-quant\Project_1\youngsig\src\gmm\model.py", line 456, in bhattacharyya_distance
    term1 = 0.125 * float(dm.T @ inv_S @ dm)
                    ~~~~~^^^^^^^^^^^^^^^^^^^
TypeError: only 0-dimensional arrays can be converted to Python scalars
2025-12-31 15:38:26 - StockClustering - INFO - main:72 - Args Data Collect : True
2025-12-31 15:38:26 - StockClustering - INFO - main:82 - Start collecting
2025-12-31 15:50:09 - StockClustering - INFO - main:86 - End   collecting
2025-12-31 16:20:24 - StockClustering - INFO - main:72 - Args Data Collect : False
2025-12-31 16:20:24 - StockClustering - INFO - main:92 - Start loading data from collected already
2025-12-31 16:20:26 - StockClustering - INFO - main:99 - End   loading data
2025-12-31 16:20:26 - StockClustering - INFO - main:106 - Start GMM clustering
2025-12-31 16:21:12 - StockClustering - ERROR - main:126 - Fatal error: only 0-dimensional arrays can be converted to Python scalars
Traceback (most recent call last):
  File "D:\ai-quant\Project_1\youngsig\src\main.py", line 108, in main
    gmm_report = gmm.run()
  File "D:\ai-quant\Project_1\youngsig\src\gmm_clustering.py", line 488, in run
    return run_gmm_pipeline(
        df=self.df,
    ...<2 lines>...
        manual_k=manual_k,
    )
  File "D:\ai-quant\Project_1\youngsig\src\gmm_clustering.py", line 179, in run_gmm_pipeline
    labels_map, probs_map, _quality_map, last_model, sort_feature = train_gmm_per_year(
                                                                    ~~~~~~~~~~~~~~~~~~^
        X_feats, years, df_clean.index, feature_cols_used, final_k
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\ai-quant\Project_1\youngsig\src\gmm\pipeline_logic.py", line 197, in train_gmm_per_year
    mapping = align_clusters(
        prev_centers,
    ...<3 lines>...
        metric=GMM_ALIGN_METRIC,
    )
  File "D:\ai-quant\Project_1\youngsig\src\gmm\model.py", line 423, in align_clusters
    cost_matrix[i, j] = bhattacharyya_distance(
                        ~~~~~~~~~~~~~~~~~~~~~~^
        curr_centers[i],
        ^^^^^^^^^^^^^^^^
    ...<2 lines>...
        _cov_mat(prev_covs[j]),
        ^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\ai-quant\Project_1\youngsig\src\gmm\model.py", line 456, in bhattacharyya_distance
    term1 = 0.125 * float(dm.T @ inv_S @ dm)
                    ~~~~~^^^^^^^^^^^^^^^^^^^
TypeError: only 0-dimensional arrays can be converted to Python scalars
